// Fetching existing position
{ table: 'position',
  action: 'partial',
  keys: [ 'account', 'symbol', 'currency' ],
  types:
   { account: 'long',
     symbol: 'symbol',
     currency: 'symbol',
     underlying: 'symbol',
     quoteCurrency: 'symbol',
     commission: 'float',
     initMarginReq: 'float',
     maintMarginReq: 'float',
     riskLimit: 'long',
     leverage: 'float',
     crossMargin: 'boolean',
     deleveragePercentile: 'float',
     rebalancedPnl: 'long',
     prevRealisedPnl: 'long',
     prevUnrealisedPnl: 'long',
     prevClosePrice: 'float',
     openingTimestamp: 'timestamp',
     openingQty: 'long',
     openingCost: 'long',
     openingComm: 'long',
     openOrderBuyQty: 'long',
     openOrderBuyCost: 'long',
     openOrderBuyPremium: 'long',
     openOrderSellQty: 'long',
     openOrderSellCost: 'long',
     openOrderSellPremium: 'long',
     execBuyQty: 'long',
     execBuyCost: 'long',
     execSellQty: 'long',
     execSellCost: 'long',
     execQty: 'long',
     execCost: 'long',
     execComm: 'long',
     currentTimestamp: 'timestamp',
     currentQty: 'long',
     currentCost: 'long',
     currentComm: 'long',
     realisedCost: 'long',
     unrealisedCost: 'long',
     grossOpenCost: 'long',
     grossOpenPremium: 'long',
     grossExecCost: 'long',
     isOpen: 'boolean',
     markPrice: 'float',
     markValue: 'long',
     riskValue: 'long',
     homeNotional: 'float',
     foreignNotional: 'float',
     posState: 'symbol',
     posCost: 'long',
     posCost2: 'long',
     posCross: 'long',
     posInit: 'long',
     posComm: 'long',
     posLoss: 'long',
     posMargin: 'long',
     posMaint: 'long',
     posAllowance: 'long',
     taxableMargin: 'long',
     initMargin: 'long',
     maintMargin: 'long',
     sessionMargin: 'long',
     targetExcessMargin: 'long',
     varMargin: 'long',
     realisedGrossPnl: 'long',
     realisedTax: 'long',
     realisedPnl: 'long',
     unrealisedGrossPnl: 'long',
     longBankrupt: 'long',
     shortBankrupt: 'long',
     taxBase: 'long',
     indicativeTaxRate: 'float',
     indicativeTax: 'long',
     unrealisedTax: 'long',
     unrealisedPnl: 'long',
     unrealisedPnlPcnt: 'float',
     unrealisedRoePcnt: 'float',
     simpleQty: 'float',
     simpleCost: 'float',
     simpleValue: 'float',
     simplePnl: 'float',
     simplePnlPcnt: 'float',
     avgCostPrice: 'float',
     avgEntryPrice: 'float',
     breakEvenPrice: 'float',
     marginCallPrice: 'float',
     liquidationPrice: 'float',
     bankruptPrice: 'float',
     timestamp: 'timestamp',
     lastPrice: 'float',
     lastValue: 'long' },
  foreignKeys: { symbol: 'instrument' },
  attributes:
   { account: 'sorted',
     symbol: 'grouped',
     currency: 'grouped',
     underlying: 'grouped',
     quoteCurrency: 'grouped' },
  filter: { account: 153475 },
  data:
   [ { account: 153475,
       symbol: 'XBTUSD',
       currency: 'XBt',
       underlying: 'XBT',
       quoteCurrency: 'USD',
       commission: 0.00075,
       initMarginReq: 1,
       maintMarginReq: 0.005,
       riskLimit: 20000000000,
       leverage: 1,
       crossMargin: false,
       deleveragePercentile: 1,
       rebalancedPnl: 14029,
       prevRealisedPnl: -19,
       prevUnrealisedPnl: 0,
       prevClosePrice: 3552,
       openingTimestamp: '2019-02-11T09:00:00.000Z',
       openingQty: -1656,
       openingCost: 46512552,
       openingComm: 576024,
       openOrderBuyQty: 0,
       openOrderBuyCost: 0,
       openOrderBuyPremium: 0,
       openOrderSellQty: 0,
       openOrderSellCost: 0,
       openOrderSellPremium: 0,
       execBuyQty: 0,
       execBuyCost: 0,
       execSellQty: 0,
       execSellCost: 0,
       execQty: 0,
       execCost: 0,
       execComm: 0,
       currentTimestamp: '2019-02-11T09:00:00.338Z',
       currentQty: -1656,
       currentCost: 46512552,
       currentComm: 576024,
       realisedCost: 48504,
       unrealisedCost: 46464048,
       grossOpenCost: 0,
       grossOpenPremium: 0,
       grossExecCost: 0,
       isOpen: true,
       markPrice: 3552,
       markValue: 46621368,
       riskValue: 46621368,
       homeNotional: -0.46621368,
       foreignNotional: 1656,
       posState: '',
       posCost: 46464048,
       posCost2: 46942982,
       posCross: 478934,
       posInit: 46464048,
       posComm: 0,
       posLoss: 478934,
       posMargin: 46464048,
       posMaint: 0,
       posAllowance: 0,
       taxableMargin: 0,
       initMargin: 0,
       maintMargin: 46621368,
       sessionMargin: 0,
       targetExcessMargin: 0,
       varMargin: 0,
       realisedGrossPnl: -48504,
       realisedTax: 0,
       realisedPnl: -624528,
       unrealisedGrossPnl: 157320,
       longBankrupt: 0,
       shortBankrupt: 0,
       taxBase: 108816,
       indicativeTaxRate: 0,
       indicativeTax: 0,
       unrealisedTax: 0,
       unrealisedPnl: 157320,
       unrealisedPnlPcnt: 0.0034,
       unrealisedRoePcnt: 0.0034,
       simpleQty: null,
       simpleCost: null,
       simpleValue: null,
       simplePnl: null,
       simplePnlPcnt: null,
       avgCostPrice: 3564,
       avgEntryPrice: 3564,
       breakEvenPrice: 3517.5,
       marginCallPrice: 100000000,
       liquidationPrice: 100000000,
       bankruptPrice: 100000000,
       timestamp: '2019-02-11T09:00:00.338Z',
       lastPrice: 3552,
       lastValue: 46621368 } ] }

// Creating a related order
{ table: 'position',
  action: 'update',
  data:
   [ { account: 153475,
       symbol: 'XBTUSD',
       currency: 'XBt',
       openOrderBuyQty: 100,
       openOrderBuyCost: -2793300,
       timestamp: '2019-02-11T09:25:49.546Z',
       currentQty: -1656,
       markPrice: 3552,
       liquidationPrice: 100000000 } ] }

// Canceling a related order
{ table: 'position',
  action: 'update',
  data:
   [ { account: 153475,
       symbol: 'XBTUSD',
       currency: 'XBt',
       openOrderBuyQty: 0,
       openOrderBuyCost: 0,
       timestamp: '2019-02-11T09:26:28.591Z',
       currentQty: -1656,
       markPrice: 3552,
       liquidationPrice: 100000000 } ] }

// Created a market order
{ table: 'position',
 action: 'update',
 data:
  [ { account: 153475,
      symbol: 'XBTUSD',
      currency: 'XBt',
      openOrderBuyQty: 10,
      openOrderBuyCost: -279250,
      timestamp: '2019-02-11T09:31:11.479Z',
      currentQty: -1656,
      markPrice: 3552,
      liquidationPrice: 100000000 } ] }

// Order filled
{ table: 'position',
  action: 'update',
  data:
   [ { account: 153475,
       symbol: 'XBTUSD',
       currency: 'XBt',
       openOrderBuyQty: 0,
       openOrderBuyCost: 0,
       execBuyQty: 10,
       execBuyCost: 279250,
       execQty: 10,
       execCost: -279250,
       execComm: 209,
       currentTimestamp: '2019-02-11T09:31:11.480Z',
       currentQty: -1646,
       currentCost: 46233302,
       currentComm: 576233,
       realisedCost: 49834,
       unrealisedCost: 46183468,
       markValue: 46339838,
       riskValue: 46339838,
       homeNotional: -0.46339838,
       foreignNotional: 1646,
       posCost: 46183468,
       posCost2: 46659510,
       posCross: 476042,
       posInit: 46183468,
       posLoss: 476042,
       posMargin: 46183468,
       maintMargin: 46339838,
       realisedGrossPnl: -49834,
       realisedPnl: -626067,
       unrealisedGrossPnl: 156370,
       unrealisedPnl: 156370,
       breakEvenPrice: 3517,
       timestamp: '2019-02-11T09:31:11.480Z',
       lastValue: 46339838,
       markPrice: 3552,
       liquidationPrice: 100000000 } ] }

// Market making orders
{ table: 'position',
  action: 'update',
  data:
   [ { account: 153475,
       symbol: 'XBTUSD',
       currency: 'XBt',
       openOrderSellQty: 10,
       openOrderSellCost: -279250,
       grossOpenCost: 279250,
       riskValue: 46619088,
       initMargin: 279879,
       timestamp: '2019-02-11T09:41:37.381Z',
       currentQty: -1646,
       markPrice: 3552,
       liquidationPrice: 100000000 } ] }
{ table: 'position',
  action: 'update',
  data:
   [ { account: 153475,
       symbol: 'XBTUSD',
       currency: 'XBt',
       openOrderBuyQty: 10,
       openOrderBuyCost: -279290,
       timestamp: '2019-02-11T09:41:42.313Z',
       currentQty: -1646,
       markPrice: 3552,
       liquidationPrice: 100000000 } ] }

// Executed sell order
{ table: 'position',
  action: 'update',
  data:
  [ { account: 153475,
      symbol: 'XBTUSD',
      currency: 'XBt',
      openOrderSellQty: 0,
      openOrderSellCost: 0,
      execSellQty: 10,
      execSellCost: 279250,
      execQty: 0,
      execCost: 0,
      execComm: 140,
      currentTimestamp: '2019-02-11T09:42:19.191Z',
      currentQty: -1656,
      currentCost: 46512552,
      currentComm: 576164,
      unrealisedCost: 46462718,
      grossOpenCost: 0,
      markValue: 46621368,
      riskValue: 46621368,
      homeNotional: -0.46621368,
      foreignNotional: 1656,
      posCost: 46462718,
      posCost2: 46938760,
      posInit: 46462718,
      posMargin: 46462718,
      initMargin: 0,
      maintMargin: 46621368,
      realisedPnl: -625998,
      unrealisedGrossPnl: 158650,
      unrealisedPnl: 158650,
      avgCostPrice: 3564.0459,
      avgEntryPrice: 3564.0459,
      breakEvenPrice: 3517.5,
      timestamp: '2019-02-11T09:42:19.191Z',
      lastValue: 46621368,
      markPrice: 3552,
      liquidationPrice: 100000000 } ] }

  // Executed buy order
{ table: 'position',
  action: 'update',
  data:
   [ { account: 153475,
       symbol: 'XBTUSD',
       currency: 'XBt',
       openOrderBuyQty: 0,
       openOrderBuyCost: 0,
       execBuyQty: 20,
       execBuyCost: 558540,
       execQty: 10,
       execCost: -279290,
       execComm: 71,
       currentTimestamp: '2019-02-11T09:52:32.503Z',
       currentQty: -1646,
       currentCost: 46233262,
       currentComm: 576095,
       realisedCost: 51116,
       unrealisedCost: 46182146,
       markValue: 46339838,
       riskValue: 46339838,
       homeNotional: -0.46339838,
       foreignNotional: 1646,
       posCost: 46182146,
       posCost2: 46655313,
       posCross: 473167,
       posInit: 46182146,
       posLoss: 473167,
       posMargin: 46182146,
       maintMargin: 46339838,
       realisedGrossPnl: -51116,
       realisedPnl: -627211,
       unrealisedGrossPnl: 157692,
       unrealisedPnl: 157692,
       breakEvenPrice: 3517,
       timestamp: '2019-02-11T09:52:32.503Z',
       lastValue: 46339838,
       markPrice: 3552,
       liquidationPrice: 100000000 } ] }

// Updating leverage
{ table: 'position',
  action: 'update',
  data:
   [ { account: 153475,
       symbol: 'XBTUSD',
       currency: 'XBt',
       initMarginReq: 0.5,
       leverage: 2,
       currentTimestamp: '2019-02-11T10:05:01.531Z',
       posInit: 23091073,
       posComm: 52310,
       posMargin: 23143383,
       posMaint: 456404,
       maintMargin: 23301075,
       unrealisedRoePcnt: 0.0068,
       marginCallPrice: 7005,
       liquidationPrice: 7005,
       bankruptPrice: 7128,
       timestamp: '2019-02-11T10:05:01.531Z',
       currentQty: -1646,
       markPrice: 3552 } ] }

// Cross leverage
{ table: 'position',
  action: 'update',
  data:
   [ { account: 153475,
       symbol: 'XBTUSD',
       currency: 'XBt',
       initMarginReq: 0.01,
       leverage: 100,
       crossMargin: true,
       currentTimestamp: '2019-02-11T10:05:29.608Z',
       posInit: 461822,
       posComm: 35338,
       posMargin: 497160,
       posMaint: 439432,
       maintMargin: 654852,
       unrealisedRoePcnt: 0.3415,
       marginCallPrice: 100000000,
       liquidationPrice: 100000000,
       bankruptPrice: 100000000,
       timestamp: '2019-02-11T10:05:29.608Z',
       currentQty: -1646,
       markPrice: 3552 } ] }

// Back to 1x leverage
{ table: 'position',
  action: 'update',
  data:
   [ { account: 153475,
       symbol: 'XBTUSD',
       currency: 'XBt',
       initMarginReq: 1,
       leverage: 1,
       crossMargin: false,
       currentTimestamp: '2019-02-11T10:05:52.843Z',
       posInit: 46182146,
       posComm: 0,
       posMargin: 46182146,
       posMaint: 0,
       maintMargin: 46339838,
       unrealisedRoePcnt: 0.0034,
       timestamp: '2019-02-11T10:05:52.843Z',
       currentQty: -1646,
       markPrice: 3552,
       liquidationPrice: 100000000 } ] } 
